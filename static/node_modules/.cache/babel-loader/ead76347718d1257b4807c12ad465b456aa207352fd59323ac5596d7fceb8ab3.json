{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar _slicedToArray = function () {\n  function sliceIterator(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"]) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n    return _arr;\n  }\n  return function (arr, i) {\n    if (Array.isArray(arr)) {\n      return arr;\n    } else if (Symbol.iterator in Object(arr)) {\n      return sliceIterator(arr, i);\n    } else {\n      throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n    }\n  };\n}();\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n  return target;\n};\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\nvar _react = require(\"react\");\nvar _react2 = _interopRequireDefault(_react);\nvar _propTypes = require(\"prop-types\");\nvar _propTypes2 = _interopRequireDefault(_propTypes);\nvar _d3Array = require(\"d3-array\");\nvar _d3Collection = require(\"d3-collection\");\nvar _d3Scale = require(\"d3-scale\");\nvar _GenericChartComponent = require(\"../GenericChartComponent\");\nvar _GenericChartComponent2 = _interopRequireDefault(_GenericChartComponent);\nvar _GenericComponent = require(\"../GenericComponent\");\nvar _utils = require(\"../utils\");\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\nvar VolumeProfileSeries = function (_Component) {\n  _inherits(VolumeProfileSeries, _Component);\n  function VolumeProfileSeries(props) {\n    _classCallCheck(this, VolumeProfileSeries);\n    var _this = _possibleConstructorReturn(this, (VolumeProfileSeries.__proto__ || Object.getPrototypeOf(VolumeProfileSeries)).call(this, props));\n    _this.renderSVG = _this.renderSVG.bind(_this);\n    _this.drawOnCanvas = _this.drawOnCanvas.bind(_this);\n    return _this;\n  }\n  _createClass(VolumeProfileSeries, [{\n    key: \"drawOnCanvas\",\n    value: function drawOnCanvas(ctx, moreProps) {\n      var xAccessor = moreProps.xAccessor,\n        width = moreProps.width;\n      var _helper = helper(this.props, moreProps, xAccessor, width),\n        rects = _helper.rects,\n        sessionBg = _helper.sessionBg;\n      _drawOnCanvas(ctx, this.props, rects, sessionBg);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return _react2.default.createElement(_GenericChartComponent2.default, {\n        svgDraw: this.renderSVG,\n        canvasDraw: this.drawOnCanvas,\n        canvasToDraw: _GenericComponent.getAxisCanvas,\n        drawOn: [\"pan\"]\n      });\n    }\n  }, {\n    key: \"renderSVG\",\n    value: function renderSVG(moreProps) {\n      var _props = this.props,\n        className = _props.className,\n        opacity = _props.opacity;\n      var _props2 = this.props,\n        showSessionBackground = _props2.showSessionBackground,\n        sessionBackGround = _props2.sessionBackGround,\n        sessionBackGroundOpacity = _props2.sessionBackGroundOpacity;\n      var xAccessor = moreProps.xAccessor,\n        width = moreProps.width;\n      var _helper2 = helper(this.props, moreProps, xAccessor, width),\n        rects = _helper2.rects,\n        sessionBg = _helper2.sessionBg;\n      var sessionBgSvg = showSessionBackground ? sessionBg.map(function (d, idx) {\n        return _react2.default.createElement(\"rect\", _extends({\n          key: idx\n        }, d, {\n          opacity: sessionBackGroundOpacity,\n          fill: sessionBackGround\n        }));\n      }) : null;\n      return _react2.default.createElement(\"g\", {\n        className: className\n      }, sessionBgSvg, rects.map(function (d, i) {\n        return _react2.default.createElement(\"g\", {\n          key: i\n        }, _react2.default.createElement(\"rect\", {\n          x: d.x,\n          y: d.y,\n          width: d.w1,\n          height: d.height,\n          fill: d.fill1,\n          stroke: d.stroke1,\n          fillOpacity: opacity\n        }), _react2.default.createElement(\"rect\", {\n          x: d.x + d.w1,\n          y: d.y,\n          width: d.w2,\n          height: d.height,\n          fill: d.fill2,\n          stroke: d.stroke2,\n          fillOpacity: opacity\n        }));\n      }));\n    }\n  }]);\n  return VolumeProfileSeries;\n}(_react.Component);\nVolumeProfileSeries.propTypes = {\n  className: _propTypes2.default.string,\n  opacity: _propTypes2.default.number,\n  showSessionBackground: _propTypes2.default.bool,\n  sessionBackGround: _propTypes2.default.string,\n  sessionBackGroundOpacity: _propTypes2.default.number\n};\nVolumeProfileSeries.defaultProps = {\n  className: \"line \",\n  bins: 20,\n  opacity: 0.5,\n  maxProfileWidthPercent: 50,\n  fill: function fill(_ref) {\n    var type = _ref.type;\n    return type === \"up\" ? \"#6BA583\" : \"#FF0000\";\n  },\n  stroke: \"#FFFFFF\",\n  showSessionBackground: false,\n  sessionBackGround: \"#4682B4\",\n  sessionBackGroundOpacity: 0.3,\n  source: function source(d) {\n    return d.close;\n  },\n  volume: function volume(d) {\n    return d.volume;\n  },\n  absoluteChange: function absoluteChange(d) {\n    return d.absoluteChange;\n  },\n  bySession: false,\n  /* eslint-disable no-unused-vars */\n  sessionStart: function sessionStart(_ref2) {\n    var d = _ref2.d,\n      i = _ref2.i,\n      plotData = _ref2.plotData;\n    return i > 0 && plotData[i - 1].date.getMonth() !== d.date.getMonth();\n  },\n  /* eslint-enable no-unused-vars */\n  orient: \"left\",\n  // // fill: ({ type }) => { var c = type === \"up\" ? \"#6BA583\" : \"#FF0000\"; console.log(type, c); return c },\n  // stroke: ({ type }) =>  type === \"up\" ? \"#6BA583\" : \"#FF0000\",\n  // stroke: \"none\",\n  partialStartOK: true,\n  partialEndOK: true\n};\nfunction helper(props, moreProps, xAccessor, width) {\n  var realXScale = moreProps.xScale,\n    yScale = moreProps.chartConfig.yScale,\n    plotData = moreProps.plotData;\n  var sessionStart = props.sessionStart,\n    bySession = props.bySession,\n    partialStartOK = props.partialStartOK,\n    partialEndOK = props.partialEndOK;\n  var bins = props.bins,\n    maxProfileWidthPercent = props.maxProfileWidthPercent,\n    source = props.source,\n    volume = props.volume,\n    absoluteChange = props.absoluteChange,\n    orient = props.orient,\n    fill = props.fill,\n    stroke = props.stroke;\n  var sessionBuilder = (0, _utils.accumulatingWindow)().discardTillStart(!partialStartOK).discardTillEnd(!partialEndOK).accumulateTill(function (d, i) {\n    return sessionStart(_extends({\n      d: d,\n      i: i\n    }, moreProps));\n  }).accumulator(_utils.identity);\n  var dx = plotData.length > 1 ? realXScale(xAccessor(plotData[1])) - realXScale(xAccessor((0, _utils.head)(plotData))) : 0;\n  var sessions = bySession ? sessionBuilder(plotData) : [plotData];\n  var allRects = sessions.map(function (session) {\n    var begin = bySession ? realXScale(xAccessor((0, _utils.head)(session))) : 0;\n    var finish = bySession ? realXScale(xAccessor((0, _utils.last)(session))) : width;\n    var sessionWidth = finish - begin + dx;\n\n    // console.log(session)\n\n    /* var histogram = d3.layout.histogram()\n    \t\t.value(source)\n    \t\t.bins(bins);*/\n\n    var histogram2 = (0, _d3Array.histogram)()\n    // .domain(xScale.domain())\n    .value(source).thresholds(bins);\n\n    // console.log(bins, histogram(session))\n    // console.log(bins, histogram2(session))\n    var rollup = (0, _d3Collection.nest)().key(function (d) {\n      return d.direction;\n    }).sortKeys(orient === \"right\" ? _d3Array.descending : _d3Array.ascending).rollup(function (leaves) {\n      return (0, _d3Array.sum)(leaves, function (d) {\n        return d.volume;\n      });\n    });\n    var values = histogram2(session);\n    // console.log(\"values\", values)\n\n    var volumeInBins = values.map(function (arr) {\n      return arr.map(function (d) {\n        return absoluteChange(d) > 0 ? {\n          direction: \"up\",\n          volume: volume(d)\n        } : {\n          direction: \"down\",\n          volume: volume(d)\n        };\n      });\n    }).map(function (arr) {\n      return rollup.entries(arr);\n    });\n\n    // console.log(\"volumeInBins\", volumeInBins)\n    var volumeValues = volumeInBins.map(function (each) {\n      return (0, _d3Array.sum)(each.map(function (d) {\n        return d.value;\n      }));\n    });\n\n    // console.log(\"volumeValues\", volumeValues)\n    var base = function base(xScale) {\n      return (0, _utils.head)(xScale.range());\n    };\n    var _ref3 = orient === \"right\" ? [begin, begin + sessionWidth * maxProfileWidthPercent / 100] : [finish, finish - sessionWidth * (100 - maxProfileWidthPercent) / 100],\n      _ref4 = _slicedToArray(_ref3, 2),\n      start = _ref4[0],\n      end = _ref4[1];\n    var xScale = (0, _d3Scale.scaleLinear)().domain([0, (0, _d3Array.max)(volumeValues)]).range([start, end]);\n\n    // console.log(xScale.domain())\n\n    var totalVolumes = volumeInBins.map(function (volumes) {\n      var totalVolume = (0, _d3Array.sum)(volumes, function (d) {\n        return d.value;\n      });\n      var totalVolumeX = xScale(totalVolume);\n      var width = base(xScale) - totalVolumeX;\n      var x = width < 0 ? totalVolumeX + width : totalVolumeX;\n      var ws = volumes.map(function (d) {\n        return {\n          type: d.key,\n          width: d.value * Math.abs(width) / totalVolume\n        };\n      });\n      return {\n        x: x,\n        ws: ws,\n        totalVolumeX: totalVolumeX\n      };\n    });\n    // console.log(\"totalVolumes\", totalVolumes)\n\n    var rects = (0, _d3Array.zip)(values, totalVolumes).map(function (_ref5) {\n      var _ref6 = _slicedToArray(_ref5, 2),\n        d = _ref6[0],\n        _ref6$ = _ref6[1],\n        x = _ref6$.x,\n        ws = _ref6$.ws;\n      var w1 = ws[0] || {\n        type: \"up\",\n        width: 0\n      };\n      var w2 = ws[1] || {\n        type: \"down\",\n        width: 0\n      };\n      return {\n        // y: yScale(d.x + d.dx),\n        y: yScale(d.x1),\n        // height: yScale(d.x - d.dx) - yScale(d.x),\n        height: yScale(d.x1) - yScale(d.x0),\n        x: x,\n        width: width,\n        w1: w1.width,\n        w2: w2.width,\n        stroke1: (0, _utils.functor)(stroke)(w1),\n        stroke2: (0, _utils.functor)(stroke)(w2),\n        fill1: (0, _utils.functor)(fill)(w1),\n        fill2: (0, _utils.functor)(fill)(w2)\n      };\n    });\n\n    // console.log(\"rects\", rects)\n\n    var sessionBg = {\n      x: begin,\n      y: (0, _utils.last)(rects).y,\n      height: (0, _utils.head)(rects).y - (0, _utils.last)(rects).y + (0, _utils.head)(rects).height,\n      width: sessionWidth\n    };\n    return {\n      rects: rects,\n      sessionBg: sessionBg\n    };\n  });\n  return {\n    rects: (0, _d3Array.merge)(allRects.map(function (d) {\n      return d.rects;\n    })),\n    sessionBg: allRects.map(function (d) {\n      return d.sessionBg;\n    })\n  };\n}\nfunction _drawOnCanvas(ctx, props, rects, sessionBg) {\n  var opacity = props.opacity,\n    sessionBackGround = props.sessionBackGround,\n    sessionBackGroundOpacity = props.sessionBackGroundOpacity,\n    showSessionBackground = props.showSessionBackground;\n\n  // var { rects, sessionBg } = helper(props, xScale, yScale, plotData);\n\n  if (showSessionBackground) {\n    ctx.fillStyle = (0, _utils.hexToRGBA)(sessionBackGround, sessionBackGroundOpacity);\n    sessionBg.forEach(function (each) {\n      var x = each.x,\n        y = each.y,\n        height = each.height,\n        width = each.width;\n      ctx.beginPath();\n      ctx.rect(x, y, width, height);\n      ctx.closePath();\n      ctx.fill();\n    });\n  }\n  rects.forEach(function (each) {\n    var x = each.x,\n      y = each.y,\n      height = each.height,\n      w1 = each.w1,\n      w2 = each.w2,\n      stroke1 = each.stroke1,\n      stroke2 = each.stroke2,\n      fill1 = each.fill1,\n      fill2 = each.fill2;\n    if (w1 > 0) {\n      ctx.fillStyle = (0, _utils.hexToRGBA)(fill1, opacity);\n      if (stroke1 !== \"none\") ctx.strokeStyle = stroke1;\n      ctx.beginPath();\n      ctx.rect(x, y, w1, height);\n      ctx.closePath();\n      ctx.fill();\n      if (stroke1 !== \"none\") ctx.stroke();\n    }\n    if (w2 > 0) {\n      ctx.fillStyle = (0, _utils.hexToRGBA)(fill2, opacity);\n      if (stroke2 !== \"none\") ctx.strokeStyle = stroke2;\n      ctx.beginPath();\n      ctx.rect(x + w1, y, w2, height);\n      ctx.closePath();\n      ctx.fill();\n      if (stroke2 !== \"none\") ctx.stroke();\n    }\n  });\n}\nexports.default = VolumeProfileSeries;","map":{"version":3,"mappings":"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","names":["VolumeProfileSeries","props","_classCallCheck","_this","renderSVG","bind","drawOnCanvas","ctx","moreProps","xAccessor","width","helper","rects","sessionBg","_react2","svgDraw","canvasDraw","canvasToDraw","drawOn","className","opacity","showSessionBackground","sessionBackGround","sessionBackGroundOpacity","sessionBgSvg","map","d","idx","key","fill","i","x","y","w1","height","fill1","stroke","stroke1","fillOpacity","w2","fill2","stroke2","propTypes","_propTypes2","string","number","bool","defaultProps","bins","maxProfileWidthPercent","type","source","close","volume","absoluteChange","bySession","sessionStart","plotData","date","getMonth","orient","partialStartOK","partialEndOK","realXScale","xScale","yScale","chartConfig","sessionBuilder","discardTillStart","discardTillEnd","accumulateTill","accumulator","dx","length","sessions","allRects","begin","session","finish","sessionWidth","histogram2","value","thresholds","rollup","direction","sortKeys","leaves","values","volumeInBins","arr","entries","volumeValues","each","base","range","_ref4","start","end","domain","totalVolumes","totalVolume","volumes","totalVolumeX","ws","Math","abs","_ref6$","x1","x0","fillStyle","forEach","beginPath","rect","closePath","strokeStyle"],"sources":["C:\\Users\\Lucian\\Documents\\DEV\\nodejs\\stock-market-api\\dev\\static\\node_modules\\src\\lib\\series\\VolumeProfileSeries.js"],"sourcesContent":["\n\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { ascending, descending, sum, max, merge, zip, histogram as d3Histogram } from \"d3-array\";\nimport { nest } from \"d3-collection\";\nimport { scaleLinear } from \"d3-scale\";\n\nimport GenericChartComponent from \"../GenericChartComponent\";\nimport { getAxisCanvas } from \"../GenericComponent\";\n\nimport { head, last, hexToRGBA, accumulatingWindow, identity, functor } from \"../utils\";\n\nclass VolumeProfileSeries extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.renderSVG = this.renderSVG.bind(this);\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\n\t}\n\tdrawOnCanvas(ctx, moreProps) {\n\t\tconst { xAccessor, width } = moreProps;\n\t\tconst { rects, sessionBg } = helper(this.props, moreProps, xAccessor, width);\n\n\t\tdrawOnCanvas(ctx, this.props, rects, sessionBg);\n\t}\n\trender() {\n\t\treturn <GenericChartComponent\n\t\t\tsvgDraw={this.renderSVG}\n\t\t\tcanvasDraw={this.drawOnCanvas}\n\t\t\tcanvasToDraw={getAxisCanvas}\n\t\t\tdrawOn={[\"pan\"]}\n\t\t/>;\n\t}\n\trenderSVG(moreProps) {\n\t\tconst { className, opacity } = this.props;\n\t\tconst { showSessionBackground, sessionBackGround, sessionBackGroundOpacity } = this.props;\n\n\t\tconst { xAccessor, width } = moreProps;\n\t\tconst { rects, sessionBg } = helper(this.props, moreProps, xAccessor, width);\n\n\t\tconst sessionBgSvg = showSessionBackground\n\t\t\t? sessionBg.map((d, idx) => <rect key={idx} {...d} opacity={sessionBackGroundOpacity} fill={sessionBackGround} />)\n\t\t\t: null;\n\n\t\treturn <g className={className}>\n\t\t\t{sessionBgSvg}\n\t\t\t{rects.map((d, i) => <g key={i}>\n\t\t\t\t<rect x={d.x} y={d.y}\n\t\t\t\t\twidth={d.w1} height={d.height}\n\t\t\t\t\tfill={d.fill1} stroke={d.stroke1} fillOpacity={opacity} />\n\t\t\t\t<rect x={d.x + d.w1} y={d.y}\n\t\t\t\t\twidth={d.w2} height={d.height}\n\t\t\t\t\tfill={d.fill2} stroke={d.stroke2} fillOpacity={opacity} />\n\t\t\t</g>)}\n\t\t</g>;\n\t}\n}\n\nVolumeProfileSeries.propTypes = {\n\tclassName: PropTypes.string,\n\topacity: PropTypes.number,\n\tshowSessionBackground: PropTypes.bool,\n\tsessionBackGround: PropTypes.string,\n\tsessionBackGroundOpacity: PropTypes.number,\n};\n\n\nVolumeProfileSeries.defaultProps = {\n\tclassName: \"line \",\n\tbins: 20,\n\topacity: 0.5,\n\tmaxProfileWidthPercent: 50,\n\tfill: ({ type }) => type === \"up\" ? \"#6BA583\" : \"#FF0000\",\n\tstroke: \"#FFFFFF\",\n\tshowSessionBackground: false,\n\tsessionBackGround: \"#4682B4\",\n\tsessionBackGroundOpacity: 0.3,\n\n\tsource: d => d.close,\n\tvolume: d => d.volume,\n\tabsoluteChange: d => d.absoluteChange,\n\tbySession: false,\n\t/* eslint-disable no-unused-vars */\n\tsessionStart: ({ d, i, plotData }) => i > 0 && plotData[i - 1].date.getMonth() !== d.date.getMonth(),\n\t/* eslint-enable no-unused-vars */\n\torient: \"left\",\n\t// // fill: ({ type }) => { var c = type === \"up\" ? \"#6BA583\" : \"#FF0000\"; console.log(type, c); return c },\n\t// stroke: ({ type }) =>  type === \"up\" ? \"#6BA583\" : \"#FF0000\",\n\t// stroke: \"none\",\n\tpartialStartOK: true,\n\tpartialEndOK: true,\n};\n\nfunction helper(props, moreProps, xAccessor, width) {\n\tconst { xScale: realXScale, chartConfig: { yScale }, plotData } = moreProps;\n\n\tconst { sessionStart, bySession, partialStartOK, partialEndOK } = props;\n\tconst { bins, maxProfileWidthPercent, source, volume, absoluteChange, orient, fill, stroke } = props;\n\n\tconst sessionBuilder = accumulatingWindow()\n\t\t.discardTillStart(!partialStartOK)\n\t\t.discardTillEnd(!partialEndOK)\n\t\t.accumulateTill((d, i) => {\n\t\t\treturn sessionStart({ d, i, ...moreProps });\n\t\t})\n\t\t.accumulator(identity);\n\n\tconst dx = plotData.length > 1 ? realXScale(xAccessor(plotData[1])) - realXScale(xAccessor(head(plotData))) : 0;\n\n\tconst sessions = bySession ? sessionBuilder(plotData) : [plotData];\n\n\tconst allRects = sessions.map(session => {\n\n\t\tconst begin = bySession ? realXScale(xAccessor(head(session))) : 0;\n\t\tconst finish = bySession ? realXScale(xAccessor(last(session))) : width;\n\t\tconst sessionWidth = finish - begin + dx;\n\n\t\t// console.log(session)\n\n\t\t/* var histogram = d3.layout.histogram()\n\t\t\t\t.value(source)\n\t\t\t\t.bins(bins);*/\n\n\t\tconst histogram2 = d3Histogram()\n\t\t\t// .domain(xScale.domain())\n\t\t\t.value(source)\n\t\t\t.thresholds(bins);\n\n\t\t// console.log(bins, histogram(session))\n\t\t// console.log(bins, histogram2(session))\n\t\tconst rollup = nest()\n\t\t\t.key(d => d.direction)\n\t\t\t.sortKeys(orient === \"right\" ? descending : ascending)\n\t\t\t.rollup(leaves => sum(leaves, d => d.volume));\n\n\t\tconst values = histogram2(session);\n\t\t// console.log(\"values\", values)\n\n\t\tconst volumeInBins = values\n\t\t\t.map(arr => arr.map(d => absoluteChange(d) > 0 ? { direction: \"up\", volume: volume(d) } : { direction: \"down\", volume: volume(d) }))\n\t\t\t.map(arr => rollup.entries(arr));\n\n\t\t// console.log(\"volumeInBins\", volumeInBins)\n\t\tconst volumeValues = volumeInBins\n\t\t\t.map(each => sum(each.map(d => d.value)));\n\n\t\t// console.log(\"volumeValues\", volumeValues)\n\t\tconst base = xScale => head(xScale.range());\n\n\t\tconst [start, end] = orient === \"right\"\n\t\t\t? [begin, begin + sessionWidth * maxProfileWidthPercent / 100]\n\t\t\t: [finish, finish - sessionWidth * (100 - maxProfileWidthPercent) / 100];\n\n\t\tconst xScale = scaleLinear()\n\t\t\t.domain([0, max(volumeValues)])\n\t\t\t.range([start, end]);\n\n\t\t// console.log(xScale.domain())\n\n\t\tconst totalVolumes = volumeInBins.map(volumes => {\n\n\t\t\tconst totalVolume = sum(volumes, d => d.value);\n\t\t\tconst totalVolumeX = xScale(totalVolume);\n\t\t\tconst width = base(xScale) - totalVolumeX;\n\t\t\tconst x = width < 0 ? totalVolumeX + width : totalVolumeX;\n\n\t\t\tconst ws = volumes.map(d => {\n\t\t\t\treturn {\n\t\t\t\t\ttype: d.key,\n\t\t\t\t\twidth: d.value * Math.abs(width) / totalVolume,\n\t\t\t\t};\n\t\t\t});\n\n\t\t\treturn { x, ws, totalVolumeX };\n\t\t});\n\t\t// console.log(\"totalVolumes\", totalVolumes)\n\n\t\tconst rects = zip(values, totalVolumes)\n\t\t\t.map(([d, { x, ws }]) => {\n\t\t\t\tconst w1 = ws[0] || { type: \"up\", width: 0 };\n\t\t\t\tconst w2 = ws[1] || { type: \"down\", width: 0 };\n\n\t\t\t\treturn {\n\t\t\t\t\t// y: yScale(d.x + d.dx),\n\t\t\t\t\ty: yScale(d.x1),\n\t\t\t\t\t// height: yScale(d.x - d.dx) - yScale(d.x),\n\t\t\t\t\theight: yScale(d.x1) - yScale(d.x0),\n\t\t\t\t\tx,\n\t\t\t\t\twidth,\n\t\t\t\t\tw1: w1.width,\n\t\t\t\t\tw2: w2.width,\n\t\t\t\t\tstroke1: functor(stroke)(w1),\n\t\t\t\t\tstroke2: functor(stroke)(w2),\n\t\t\t\t\tfill1: functor(fill)(w1),\n\t\t\t\t\tfill2: functor(fill)(w2),\n\t\t\t\t};\n\t\t\t});\n\n\t\t// console.log(\"rects\", rects)\n\n\t\tconst sessionBg = {\n\t\t\tx: begin,\n\t\t\ty: last(rects).y,\n\t\t\theight: head(rects).y - last(rects).y + head(rects).height,\n\t\t\twidth: sessionWidth,\n\t\t};\n\n\t\treturn { rects, sessionBg };\n\t});\n\n\treturn {\n\t\trects: merge(allRects.map(d => d.rects)),\n\t\tsessionBg: allRects.map(d => d.sessionBg),\n\t};\n}\n\n\nfunction drawOnCanvas(ctx, props, rects, sessionBg) {\n\tconst { opacity, sessionBackGround, sessionBackGroundOpacity, showSessionBackground } = props;\n\n\t// var { rects, sessionBg } = helper(props, xScale, yScale, plotData);\n\n\tif (showSessionBackground) {\n\t\tctx.fillStyle = hexToRGBA(sessionBackGround, sessionBackGroundOpacity);\n\n\t\tsessionBg.forEach(each => {\n\t\t\tconst { x, y, height, width } = each;\n\n\t\t\tctx.beginPath();\n\t\t\tctx.rect(x, y, width, height);\n\t\t\tctx.closePath();\n\t\t\tctx.fill();\n\t\t});\n\t}\n\n\trects.forEach(each => {\n\t\tconst { x, y, height, w1, w2, stroke1, stroke2, fill1, fill2 } = each;\n\n\n\t\tif (w1 > 0) {\n\t\t\tctx.fillStyle = hexToRGBA(fill1, opacity);\n\t\t\tif (stroke1 !== \"none\") ctx.strokeStyle = stroke1;\n\n\t\t\tctx.beginPath();\n\t\t\tctx.rect(x, y, w1, height);\n\t\t\tctx.closePath();\n\t\t\tctx.fill();\n\n\t\t\tif (stroke1 !== \"none\") ctx.stroke();\n\t\t}\n\n\t\tif (w2 > 0) {\n\t\t\tctx.fillStyle = hexToRGBA(fill2, opacity);\n\t\t\tif (stroke2 !== \"none\") ctx.strokeStyle = stroke2;\n\n\t\t\tctx.beginPath();\n\t\t\tctx.rect(x + w1, y, w2, height);\n\t\t\tctx.closePath();\n\t\t\tctx.fill();\n\n\t\t\tif (stroke2 !== \"none\") ctx.stroke();\n\t\t}\n\n\t});\n}\n\nexport default VolumeProfileSeries;\n"]},"metadata":{},"sourceType":"script","externalDependencies":[]}