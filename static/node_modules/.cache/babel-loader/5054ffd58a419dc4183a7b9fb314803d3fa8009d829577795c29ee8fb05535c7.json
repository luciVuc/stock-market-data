{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar _saveSvgAsPng = require(\"save-svg-as-png\");\nvar _saveSvgAsPng2 = _interopRequireDefault(_saveSvgAsPng);\nvar _utils = require(\"../utils\");\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\nvar dx = 0;\nvar dy = 0;\nvar SaveChartAsImage = {\n  save: function save(doc, container, background, cb) {\n    _saveSvgAsPng2.default.svgAsDataUri(container.getElementsByTagName(\"svg\")[0], {}, function (uri) {\n      // eslint-disable-next-line prefer-const\n      var image = new Image();\n      image.onload = function () {\n        // eslint-disable-next-line prefer-const\n        var canvas = doc.createElement(\"canvas\");\n        canvas.width = image.width;\n        canvas.height = image.height;\n\n        // eslint-disable-next-line prefer-const\n        var context = canvas.getContext(\"2d\");\n        if ((0, _utils.isDefined)(background)) {\n          context.fillStyle = background;\n          context.fillRect(0, 0, canvas.width, canvas.height);\n        }\n        var canvasList = container.getElementsByTagName(\"canvas\");\n        for (var i = 0; i < canvasList.length; i++) {\n          var each = canvasList[i];\n          if ((0, _utils.isDefined)(each)) {\n            var parent = each.parentNode.parentNode.getBoundingClientRect();\n            var rect = each.getBoundingClientRect();\n            context.drawImage(each, rect.left - parent.left + dx, rect.top - parent.top + dy);\n          }\n        }\n        context.drawImage(image, dx, dy);\n        cb(canvas.toDataURL(\"image/png\"));\n      };\n      image.src = uri;\n    });\n  },\n  saveWithWhiteBG: function saveWithWhiteBG(doc, container, cb) {\n    return this.saveWithBG(doc, container, \"white\", cb);\n  },\n  saveWithDarkBG: function saveWithDarkBG(doc, container, cb) {\n    return this.saveWithBG(doc, container, \"#303030\", cb);\n  },\n  saveWithBG: function saveWithBG(doc, container, background, cb) {\n    return this.save(doc, container, background, cb);\n  },\n  saveChartAsImage: function saveChartAsImage(container) {\n    this.saveWithWhiteBG(document, container, function (src) {\n      var a = document.createElement(\"a\");\n      a.setAttribute(\"href\", src);\n      a.setAttribute(\"download\", \"Chart.png\");\n      document.body.appendChild(a);\n      a.addEventListener(\"click\", function () /* e */{\n        a.parentNode.removeChild(a);\n      });\n      a.click();\n    });\n  }\n};\nexports.default = SaveChartAsImage;","map":{"version":3,"mappings":";;;;;AAEA;;AACA;;;;;;AAEA,IAAMA,KAAK,CAAX;AACA,IAAMC,KAAK,CAAX;AAEA,IAAMC,mBAAmB;EACxBC,IADwB,gBACnBC,GADmB,EACdC,SADc,EACHC,UADG,EACSC,EADT,EACa;IACpCC,uBAAUC,YAAV,CAAuBJ,UAAUK,oBAAV,CAA+B,KAA/B,EAAsC,CAAtC,CAAvB,EAAiE,EAAjE,EAAqE,UAASC,GAAT,EAAc;MAClF;MACA,IAAIC,QAAQ,IAAIC,KAAJ,EAAZ;MACAD,MAAME,MAAN,GAAe,YAAW;QAEzB;QACA,IAAIC,SAASX,IAAIY,aAAJ,CAAkB,QAAlB,CAAb;QACAD,OAAOE,KAAP,GAAeL,MAAMK,KAArB;QACAF,OAAOG,MAAP,GAAgBN,MAAMM,MAAtB;;QAEA;QACA,IAAIC,UAAUJ,OAAOK,UAAP,CAAkB,IAAlB,CAAd;QAEA,IAAI,sBAAUd,UAAV,CAAJ,EAA2B;UAC1Ba,QAAQE,SAAR,GAAoBf,UAApB;UACAa,QAAQG,QAAR,CAAiB,CAAjB,EAAoB,CAApB,EAAuBP,OAAOE,KAA9B,EAAqCF,OAAOG,MAA5C;QACA;QACD,IAAMK,aAAalB,UAAUK,oBAAV,CAA+B,QAA/B,CAAnB;QACA,KAAK,IAAIc,IAAI,CAAb,EAAgBA,IAAID,WAAWE,MAA/B,EAAuCD,GAAvC,EAA4C;UAC3C,IAAME,OAAOH,WAAWC,CAAX,CAAb;UACA,IAAI,sBAAUE,IAAV,CAAJ,EAAqB;YACpB,IAAMC,SAASD,KAAKE,UAAL,CAAgBA,UAAhB,CAA2BC,qBAA3B,EAAf;YACA,IAAMC,OAAOJ,KAAKG,qBAAL,EAAb;YACAV,QAAQY,SAAR,CAAkBL,IAAlB,EAAwBI,KAAKE,IAAL,GAAYL,OAAOK,IAAnB,GAA0BhC,EAAlD,EAAsD8B,KAAKG,GAAL,GAAWN,OAAOM,GAAlB,GAAwBhC,EAA9E;UACA;QACD;QAEDkB,QAAQY,SAAR,CAAkBnB,KAAlB,EAAyBZ,EAAzB,EAA6BC,EAA7B;QACAM,GAAGQ,OAAOmB,SAAP,CAAiB,WAAjB,CAAH;MACA,CA1BD;MA2BAtB,MAAMuB,GAAN,GAAYxB,GAAZ;IACA,CA/BD;EAgCA,CAlCuB;EAmCxByB,eAnCwB,2BAmCRhC,GAnCQ,EAmCHC,SAnCG,EAmCQE,EAnCR,EAmCY;IACnC,OAAO,KAAK8B,UAAL,CAAgBjC,GAAhB,EAAqBC,SAArB,EAAgC,OAAhC,EAAyCE,EAAzC,CAAP;EACA,CArCuB;EAsCxB+B,cAtCwB,0BAsCTlC,GAtCS,EAsCJC,SAtCI,EAsCOE,EAtCP,EAsCW;IAClC,OAAO,KAAK8B,UAAL,CAAgBjC,GAAhB,EAAqBC,SAArB,EAAgC,SAAhC,EAA2CE,EAA3C,CAAP;EACA,CAxCuB;EAyCxB8B,UAzCwB,sBAyCbjC,GAzCa,EAyCRC,SAzCQ,EAyCGC,UAzCH,EAyCeC,EAzCf,EAyCmB;IAC1C,OAAO,KAAKJ,IAAL,CAAUC,GAAV,EAAeC,SAAf,EAA0BC,UAA1B,EAAsCC,EAAtC,CAAP;EACA,CA3CuB;EA4CxBgC,gBA5CwB,4BA4CPlC,SA5CO,EA4CI;IAC3B,KAAK+B,eAAL,CAAqBI,QAArB,EAA+BnC,SAA/B,EAA0C,UAAS8B,GAAT,EAAc;MACvD,IAAMM,IAAID,SAASxB,aAAT,CAAuB,GAAvB,CAAV;MACAyB,EAAEC,YAAF,CAAe,MAAf,EAAuBP,GAAvB;MACAM,EAAEC,YAAF,CAAe,UAAf,EAA2B,WAA3B;MAEAF,SAASG,IAAT,CAAcC,WAAd,CAA0BH,CAA1B;MACAA,EAAEI,gBAAF,CAAmB,OAAnB,EAA4B,YAAS,OAAS;QAC7CJ,EAAEb,UAAF,CAAakB,WAAb,CAAyBL,CAAzB;MACA,CAFD;MAIAA,EAAEM,KAAF;IACA,CAXD;EAYA;AAzDuB,CAAzB;kBA4De7C,gB","names":["dx","dy","SaveChartAsImage","save","doc","container","background","cb","_saveSvgAsPng2","svgAsDataUri","getElementsByTagName","uri","image","Image","onload","canvas","createElement","width","height","context","getContext","fillStyle","fillRect","canvasList","i","length","each","parent","parentNode","getBoundingClientRect","rect","drawImage","left","top","toDataURL","src","saveWithWhiteBG","saveWithBG","saveWithDarkBG","saveChartAsImage","document","a","setAttribute","body","appendChild","addEventListener","removeChild","click"],"sources":["C:\\Users\\Lucian\\Documents\\DEV\\nodejs\\stock-market-api\\dev\\static\\node_modules\\src\\lib\\helper\\SaveChartAsImage.js"],"sourcesContent":["\n\nimport saveAsPng from \"save-svg-as-png\";\nimport { isDefined } from \"../utils\";\n\nconst dx = 0;\nconst dy = 0;\n\nconst SaveChartAsImage = {\n\tsave(doc, container, background, cb) {\n\t\tsaveAsPng.svgAsDataUri(container.getElementsByTagName(\"svg\")[0], {}, function(uri) {\n\t\t\t// eslint-disable-next-line prefer-const\n\t\t\tlet image = new Image();\n\t\t\timage.onload = function() {\n\n\t\t\t\t// eslint-disable-next-line prefer-const\n\t\t\t\tlet canvas = doc.createElement(\"canvas\");\n\t\t\t\tcanvas.width = image.width;\n\t\t\t\tcanvas.height = image.height;\n\n\t\t\t\t// eslint-disable-next-line prefer-const\n\t\t\t\tlet context = canvas.getContext(\"2d\");\n\n\t\t\t\tif (isDefined(background)) {\n\t\t\t\t\tcontext.fillStyle = background;\n\t\t\t\t\tcontext.fillRect(0, 0, canvas.width, canvas.height);\n\t\t\t\t}\n\t\t\t\tconst canvasList = container.getElementsByTagName(\"canvas\");\n\t\t\t\tfor (let i = 0; i < canvasList.length; i++) {\n\t\t\t\t\tconst each = canvasList[i];\n\t\t\t\t\tif (isDefined(each)) {\n\t\t\t\t\t\tconst parent = each.parentNode.parentNode.getBoundingClientRect();\n\t\t\t\t\t\tconst rect = each.getBoundingClientRect();\n\t\t\t\t\t\tcontext.drawImage(each, rect.left - parent.left + dx, rect.top - parent.top + dy);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tcontext.drawImage(image, dx, dy);\n\t\t\t\tcb(canvas.toDataURL(\"image/png\"));\n\t\t\t};\n\t\t\timage.src = uri;\n\t\t});\n\t},\n\tsaveWithWhiteBG(doc, container, cb) {\n\t\treturn this.saveWithBG(doc, container, \"white\", cb);\n\t},\n\tsaveWithDarkBG(doc, container, cb) {\n\t\treturn this.saveWithBG(doc, container, \"#303030\", cb);\n\t},\n\tsaveWithBG(doc, container, background, cb) {\n\t\treturn this.save(doc, container, background, cb);\n\t},\n\tsaveChartAsImage(container) {\n\t\tthis.saveWithWhiteBG(document, container, function(src) {\n\t\t\tconst a = document.createElement(\"a\");\n\t\t\ta.setAttribute(\"href\", src);\n\t\t\ta.setAttribute(\"download\", \"Chart.png\");\n\n\t\t\tdocument.body.appendChild(a);\n\t\t\ta.addEventListener(\"click\", function(/* e */) {\n\t\t\t\ta.parentNode.removeChild(a);\n\t\t\t});\n\n\t\t\ta.click();\n\t\t});\n\t}\n};\n\nexport default SaveChartAsImage;"]},"metadata":{},"sourceType":"script","externalDependencies":[]}